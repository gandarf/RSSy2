# 설계 문서: RSSy2 - AI 기반 RSS 피드 요약기

## 1. 개요
이 문서는 RSSy2 애플리케이션의 설계 및 사양을 설명합니다. RSSy2는 RSS 피드를 주기적으로 가져와 Gemini AI 모델을 사용하여 내용을 요약하고, 이 요약들을 깔끔하고 보고서 형식으로 제공하는 애플리케이션입니다. 주요 목표는 사용자가 여러 소스의 뉴스 및 기사를 정보 과부하 없이 효율적으로 소비할 수 있도록 하는 것입니다.

## 2. 기능

### 2.1 핵심 기능
- **자동 RSS 가져오기:** 애플리케이션은 설정된 RSS 피드 URL 목록에서 주기적으로(예: 매시간, 구성 가능) 새로운 항목을 읽고 검색합니다.
- **AI 기반 요약:** 각 새 RSS 피드 항목에 대해 내용은 Gemini AI 모델에 의해 처리되어 핵심 요점을 간결하게 요약합니다.
- **메인 표시 화면:** 기본 인터페이스(예: 웹 대시보드 또는 풍부한 CLI 출력)는 요약된 보고서를 읽기 쉬운 형식으로 표시하며, 피드 소스 또는 주제별로 분류될 수 있습니다.
- **보고서 생성:** 요약은 "깔끔한 보고서 형식"으로 제공되며, 가독성과 빠른 정보 검색에 중점을 둡니다. 여기에는 제목, 출처, 원본 링크 및 Gemini가 생성한 요약이 포함될 수 있습니다. 만일 RSS feed에서 가져올 수 있는 유의미한 사진이 있다면 사진도 보고서에 포함이 될 수 있습니다. 보고서는 기본적으로 2시간에 한 번씩 feed를 가져와서 보고서를 생성해서 최신 보고서를 cache해 두고 보여 주며 새로 feed를 읽어 올 경우 이전 보고서는 지우고 새 보고서로 갱신합니다. 별도의 refresh 버튼을 누르면 바로 feed를 읽어들여 보고서 생성을 합니다.

### 2.2 설정 화면
- **RSS 피드 관리:** 전용 설정 인터페이스를 통해 사용자는 다음을 수행할 수 있습니다:
    - 새 RSS 피드 URL 추가.
    - 기존 RSS 피드 URL 편집.
    - RSS 피드 URL 삭제.
    - 개별 피드 활성화/비활성화.
- **스케줄링 옵션:** RSS 피드 가져오기 빈도를 설정하기 위한 기본 제어 기능.
- **Gemini API 키 관리:** Gemini API 키의 보안 저장 및 관리.

## 3. 기술 스택

- **백엔드 언어:** Python 3.x
- **AI 통합:** Google Gemini API (공식 또는 커뮤니티 Python 클라이언트 라이브러리 사용).
- **웹 프레임워크 (UI에 적용 가능한 경우):** 메인 디스플레이 및 구성에 웹 기반 대시보드를 선택한 경우 경량 웹 서비스를 위한 Flask 또는 FastAPI.
- **데이터 저장:** 복잡도를 낮추기 위해 별도의 데이터베이스 대신, JSON 파일 또는 간단한 파일 시스템 기반의 저장을 사용합니다. (예: `feeds.json`, `articles.json`)
- **스케줄러:** 주기적인 작업을 위해 `APScheduler` 또는 애플리케이션에서 관리하는 간단한 `cron` 작업.
- **배포 환경:** 가정용 Linux 서버 (예: Raspberry Pi, NAS 또는 Linux를 실행하는 구형 데스크톱).

## 4. 아키텍처

애플리케이션은 다음과 같은 구성 요소로 나눌 수 있는 모듈식 아키텍처를 따릅니다.

- **스케줄러 모듈:** 정의된 간격으로 피드 가져오기 프로세스를 트리거하는 역할을 합니다.
- **RSS 가져오기 모듈:** 구성된 RSS URL에서 XML/JSON 데이터를 검색하고, 이를 파싱하여 관련 기사 정보(제목, 링크, 내용/설명)를 추출합니다.
- **Gemini 요약기 모듈:** Gemini API와 상호 작용하여 기사 내용을 전송하고 요약을 수신합니다. 재시도 메커니즘 및 오류 처리를 포함합니다.
- **데이터 저장 모듈:** 피드, 기사 및 요약을 JSON 파일 또는 기타 파일 기반 형식으로 저장하고 관리하는 역할을 합니다.
- **표시 모듈:** 요약된 보고서를 표시용으로 렌더링합니다(예: 웹 인터페이스용 HTML 템플릿 또는 CLI용 형식화된 콘솔 출력).
- **구성 모듈:** RSS 피드 URL 및 스케줄링 기본 설정을 포함한 설정을 관리합니다.

```
+----------------+       +-------------------+       +--------------------+
| 스케줄러       | ----> | RSS 가져오기      | ----> | Gemini 요약기      |
| (예: APScheduler) |   | (예: feedparser)  |       | (Gemini API)       |
+----------------+       +-------------------+       +--------------------+
        |                               ^
        v                               |
+--------------------+               +--------------------+
| 데이터 저장소      | <------------ | 데이터 저장소      |
| (JSON 파일)        | (기사 쓰기)   | (피드 읽기)        |
+--------------------+               +--------------------+
        |
        v
+--------------------+
| 표시 모듈          |
| (웹 UI/CLI 출력)   |
+--------------------+
        ^
        |
+--------------------+
| 구성 UI            |
| (웹 UI/CLI 구성)   |
+--------------------+
```

## 5. 데이터 모델 (JSON 파일 기반)

애플리케이션은 `feeds.json`과 `articles.json` 두 개의 주요 JSON 파일을 사용하여 데이터를 저장합니다.

### 파일: `feeds.json`
`feeds.json` 파일은 RSS 피드 목록을 저장하며, 각 피드는 고유한 ID를 가진 객체로 표현됩니다.

```json
[
  {
    "id": "uuid-1",
    "url": "https://example.com/rss1",
    "name": "Example Feed 1",
    "is_active": true,
    "last_fetched_at": "2023-10-27T10:00:00Z"
  },
  {
    "id": "uuid-2",
    "url": "https://example.com/rss2",
    "name": "Example Feed 2",
    "is_active": false,
    "last_fetched_at": "2023-10-27T09:30:00Z"
  }
]
```

**필드 설명:**
- `id` (STRING): 각 피드의 고유 식별자 (예: UUID).
- `url` (STRING): RSS 피드의 URL.
- `name` (STRING, 선택 사항): 피드의 사용자 친화적인 이름.
- `is_active` (BOOLEAN): 피드가 현재 활성화되어 가져오기 대상인지 여부.
- `last_fetched_at` (DATETIME, ISO 8601 형식): 마지막으로 피드를 성공적으로 가져온 시간.

### 파일: `articles.json`
`articles.json` 파일은 가져온 기사 및 요약 정보를 저장합니다. 각 기사는 고유한 ID를 가지며, 어떤 피드에 속하는지 `feed_id`로 참조합니다. 새로운 피드를 가져올 때마다 이 파일의 내용은 새로 갱신됩니다.

```json
[
  {
    "id": "uuid-article-1",
    "feed_id": "uuid-1",
    "title": "Article Title 1",
    "original_url": "https://example.com/article1",
    "published_at": "2023-10-27T09:45:00Z",
    "raw_content": "Full content of the article...",
    "summary": "Gemini generated summary of article 1.",
    "summarized_at": "2023-10-27T10:05:00Z",
    "image_url": "https://pimg.mk.co.kr/news/cms/202512/08/news-p.v1.20251208.99aa5d14ec824fe98567fd52fb2d6cc5_R.jpg"
  },
  {
    "id": "uuid-article-2",
    "feed_id": "uuid-2",
    "title": "Article Title 2",
    "original_url": "https://example.com/article2",
    "published_at": "2023-10-27T09:15:00Z",
    "raw_content": "Full content of the article...",
    "summary": "Gemini generated summary of article 2.",
    "summarized_at": "2023-10-27T09:50:00Z",
    "image_url": "https://pimg.mk.co.kr/news/cms/202512/08/news-p.v1.20251208.99aa5d14ec824fe98567fd52fb2d6cc5_R.jpg"
  }
]
```

**필드 설명:**
- `id` (STRING): 각 기사의 고유 식별자 (예: UUID).
- `feed_id` (STRING): 이 기사가 속한 피드의 `id`.
- `title` (STRING): 기사의 제목.
- `original_url` (STRING): 원본 기사의 URL.
- `published_at` (DATETIME, ISO 8601 형식): 기사가 게시된 시간.
- `raw_content` (STRING, 선택 사항): 원본 기사의 전체 또는 일부 내용.
- `summary` (STRING): Gemini AI 모델이 생성한 기사 요약.
- `summarized_at` (DATETIME, ISO 8601 형식): 요약이 생성된 시간.
- `image_url` (STRING, 선택 사항): Feed 안에 `media` 태그를 통해 이미지가 있는 경우 해당 이미지의 URL.

## 6. UI/UX 고려 사항

### 6.1 메인 디스플레이
- **웹 인터페이스:** (가정용 서버에 선호) 요약된 기사 목록을 보여주는 간단하고 반응형 웹 대시보드. 각 요약은 더 많은 세부 정보를 표시하거나 원본 기사로 연결하기 위해 확장될 수 있습니다. 피드, 날짜, 키워드별 필터링 및 정렬 옵션은 유용성을 향상시킬 것입니다.
- **CLI 인터페이스:** 페이지 매김 및 검색 기능과 함께 요약을 터미널에 직접 출력하는 명령줄 도구.

### 6.2 구성
- **웹 인터페이스:** RSS 피드 관리, API 키 입력 및 일정 설정을 위한 양식.
- **CLI 인터페이스:** 피드 추가, 제거, 나열 및 기타 설정 관리를 위한 명령.

## 7. 개발 로드맵 (고수준)

1. **프로젝트 설정:** Python 프로젝트 초기화, 가상 환경 설정, 기본 종속성 관리.
2. **데이터 파일 설정:** RSS 피드 및 기사 데이터를 저장하기 위한 JSON 파일 구조 정의 및 초기화.
3. **RSS 가져오기:** RSS 피드를 가져오고 파싱하는 기능 구현.
4. **Gemini 통합:** 요약을 위한 Gemini API 호출 구현.
5. **데이터 저장 로직:** 가져온 기사 및 요약을 JSON 파일에 저장.
6. **메인 디스플레이 (기본):** 요약을 볼 수 있는 기본적인 방법 구현 (CLI 또는 간단한 HTML 페이지).
7. **구성 (기본):** RSS 피드 관리를 위한 CLI 명령 또는 기본 웹 양식 구현.
8. **스케줄링:** 주기적인 가져오기를 위한 스케줄러 통합.
9. **오류 처리 및 로깅:** 강력한 오류 처리, 로깅 및 재시도 메커니즘.
10. **개선:** UI/UX 개선, 더 많은 구성 옵션 추가, 보고서 형식 개선.
11. **배포 스크립트:** Linux 서버에 배포하기 위한 기본 스크립트 또는 지침.

## 8. 향후 개선 사항

- **사용자 인증:** 여러 사용자가 의도된 경우.
- **고급 필터링/검색:** 요약 내에서 더 강력한 검색 기능.
- **카테고리/태그 지정:** 기사의 자동 또는 수동 카테고리 지정.
- **알림 시스템:** 새 요약에 대한 이메일 또는 푸시 알림.
- **감정 분석:** Gemini를 사용하여 기사의 감정 분석.
- **도커라이제이션:** 더 쉬운 배포를 위해 애플리케이션을 도커 컨테이너에 패키징.
